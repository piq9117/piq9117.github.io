<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>piq9117 - Nix - Calling a project with a flake file</title>
        <link href="https://fonts.googleapis.com/css?family=Nanum+Gothic+Coding&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=EB+Garamond&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="../css/default.css" />
    </head>
    <body>
        <header>
            <div class="logo">
                <a href="../">piq9117</a>
            </div>
            <nav>
                <a href="../">home</a>
                <a href="../about.html">about</a>
                <a href="../contact.html">contact</a>
            </nav>
        </header>

        <main role="main">
            <h1>Nix - Calling a project with a flake file</h1>
            <article>
    <section class="header">
        Posted on May  1, 2023
        
    </section>
    <section>
        <p>It hasn’t been that long since I’ve been using flakes, and only recently started looking into consuming projects that are using flakes. I’m used to consuming projects with nix derivation files in them and using <code class="codeLine">callPackage</code> on them but I had no clue on how to do it on projects with flake files. I don’t think there’s a place where nix documentation is consolidated so I googled “How to use nix callPackage on a project with a flake file”. To no one’s surprise, it didn’t return anything useful. Sure, it returned a lot of results about nix flake tutorial but nothing in the first page about consuming a project that is using a nix flakes, and of course I didn’t go beyond the first page of google results. I imagine beyond the first page of google search result is where you’ll find <a href="https://youtu.be/H4dGpz6cnHo">the backrooms</a></p>
<p>My second attempt at seeking help was the nix discord, but all I got was</p>
<blockquote>
<p>Just use callPackage then.</p>
</blockquote>
<p>Thank you, that was very helpful.</p>
<p>Thankfully <a href="https://openai.com/blog/chatgpt">chatgpt</a> came in to the rescue and provided me with the answer that I needed. It’s suggestion was to use</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode nix"><code class="sourceCode nix"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="bu">builtins</span>.getFlake <span class="st">&quot;&lt;repository url and revision&gt;&quot;</span></span></code></pre></div>
<p>So this is what I did for my overlay</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode nix"><code class="sourceCode nix"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="va">self</span><span class="op">:</span> <span class="va">super</span><span class="op">:</span> <span class="op">{</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="va">hsPkgs</span> <span class="op">=</span> super.haskell.packages.ghc944.override <span class="op">{</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="va">overrides</span> <span class="op">=</span> <span class="va">hself</span><span class="op">:</span> <span class="va">hsuper</span><span class="op">:</span> <span class="op">{</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>      <span class="va">tie</span> <span class="op">=</span> <span class="op">(</span><span class="bu">builtins</span>.getFlake <span class="st">&quot;github:piq9117/tie/b53c3f909a70ff5576734d0d668b62951d117972&quot;</span><span class="op">)</span>.outputs.packages.$<span class="op">{</span><span class="va">self</span>.<span class="va">stdenv</span>.<span class="va">hostPlatform</span>.<span class="va">system</span><span class="op">}</span>.default<span class="op">;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>      ...</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>I built it with <code class="codeLine">nix build</code>. A few seconds later out my <code class="codeLine">result</code> directory. Success!</p>
    </section>
</article>

        </main>

        <footer>
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
            <img referrerpolicy="no-referrer-when-downgrade" src="https://static.scarf.sh/a.png?x-pxid=db6c3007-dc77-4ac5-8ce3-46e1138f9016" />
        </footer>
    </body>
</html>
